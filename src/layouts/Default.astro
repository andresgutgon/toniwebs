---
import { SEO } from 'astro-seo'

import type { SitePage } from '@sites/types'
import { buildCanonicalAndAlternate } from '@sites/index'

export interface Props { page: SitePage }

const { site: config } = Astro.props
const {
  locale,
  page,
  currentUrl,
  canonicalUrl,
  localeAlternate,
  alternateUrls,
} = config
const { title, description } = page.meta
const og = page.openGraph
const openGraph = {
  basic: {
    ...og.basic,
    url: currentUrl
  },
  image: page.openGraph.image,
  optional: { description, localeAlternate }
}
---
<html lang={locale}>
  <head>
    <SEO
      title={title}
      description={description}
      canonical={canonicalUrl.url}
      openGraph={openGraph}
      extend={{
        meta: [
          { charset: 'utf-8' },
          { name: 'viewport', content: 'width=device-width' },
        ],
        link: [
          { rel: "icon", href: "/favicon.ico" },
          ...alternateUrls.map(alternate => ({
            href: alternate.url,
            rel: 'alternate',
            hrefLang: alternate.locale
          }))
        ]
      }}
    />
  </head>
  <body>
    <slot />
  </body>
</html>
